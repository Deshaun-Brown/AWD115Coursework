@model Part
@{
    ViewData["Title"] = Model.Id == 0 ? "Add Part" : "Edit Part";
}
<div class="mx-auto max-w-md px-4 py-10">
    <h1 class="text-2xl font-bold text-gray-900">@ViewData["Title"]</h1>
    <hr class="my-4 border-gray-200"/>
    <form asp-action="AddEdit" method="post" class="space-y-6">
        <input type="hidden" asp-for="Id" />
        <input type="hidden" asp-for="SupplierId" />

        <div>
            <label asp-for="PartName" class="block text-sm font-medium text-gray-700 mb-2"></label>
            <input asp-for="PartName" class="mt-1 block w-full rounded-md border-2 border-gray-400 bg-gray-100 px-4 py-3 text-gray-900 shadow-lg focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500 focus:bg-white sm:text-sm font-medium" style="text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);" />
            <span asp-validation-for="PartName" class="text-red-600 text-sm"></span>
        </div>

        <div>
            <label asp-for="NIIN" class="block text-sm font-medium text-gray-700 mb-2"></label>
            <input asp-for="NIIN" class="mt-1 block w-full rounded-md border-2 border-gray-400 bg-gray-100 px-4 py-3 text-gray-900 shadow-lg focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500 focus:bg-white sm:text-sm font-medium" style="text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);" />
            <span asp-validation-for="NIIN" class="text-red-600 text-sm"></span>
        </div>

        <div>
            <label asp-for="Manufacturer" class="block text-sm font-medium text-gray-700 mb-2"></label>
            <input asp-for="Manufacturer"
                   list="manufacturerList"
                   autocomplete="off"
                   class="mt-1 block w-full rounded-md border-2 border-gray-400 bg-gray-100 px-4 py-3 text-gray-900 shadow-lg focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500 focus:bg-white sm:text-sm font-medium"
                   style="text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);" />
            <datalist id="manufacturerList"></datalist>
            <span asp-validation-for="Manufacturer" class="text-red-600 text-sm"></span>
        </div>

        <div>
            <label asp-for="QuantityInStock" class="block text-sm font-medium text-gray-700 mb-2"></label>
            <input asp-for="QuantityInStock" type="number" class="mt-1 block w-full rounded-md border-2 border-gray-400 bg-gray-100 px-4 py-3 text-gray-900 shadow-lg focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500 focus:bg-white sm:text-sm font-medium" style="text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);" />
            <span asp-validation-for="QuantityInStock" class="text-red-600 text-sm"></span>
        </div>

        <div>
            <button type="submit" class="w-full rounded-md bg-indigo-600 px-4 py-2 text-white font-medium hover:bg-indigo-700 focus:outline-2 focus:outline-offset-2 focus:outline-indigo-500 shadow-lg">
                @(Model.Id == 0 ? "Add New Part" : "Update Part")
            </button>
        </div>
    </form>
</div>

@section Scripts {
<script>
(() => {
    const input = document.getElementById("Manufacturer");
    const list = document.getElementById("manufacturerList");
    if (!input || !list) return;

    async function loadSuggestions() {
        const term = input.value ?? "";
        const url = `@Url.Action("ManufacturerSuggestions", "Parts")?term=${encodeURIComponent(term)}`;
        const res = await fetch(url, { headers: { "Accept": "application/json" } });
        if (!res.ok) return;

        const data = await res.json();
        list.innerHTML = "";
        for (const v of data) {
            const opt = document.createElement("option");
            opt.value = v;
            list.appendChild(opt);
        }
    }

    // "hover" isn't how datalist works; load on focus + typing.
    input.addEventListener("focus", loadSuggestions);
    input.addEventListener("input", loadSuggestions);
})();
</script>
}